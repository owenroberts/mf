!function(){"use strict";function t(t,e,n){const a=[];let o,s,i,c=0,r=2,d=!1,l="start",m={cat:t,dog:e};w();let u=new CFGGenerator({tagChance:1,filterChance:1});function p(t,e){return Cool.randomInt(t||1,e||3)}function w(){l="start";const[t,e]=Cool.shuffle(["cat","dog"]);o=m[t],a.push({speaker:t,text:"I'm hungry.",delay:p()}),a.push({speaker:e,text:"Me too.",delay:p()}),a.push({speaker:t,text:"When will we eat again?",delay:p()}),a.push({speaker:e,text:"I don't know.",delay:p()}),a.push({speaker:t,text:"Should we watch some tv?",delay:p()})}return async function(){const t=await fetch("./text_tools/data/FEAR_AND_TREMBLING-cfg.json").then((t=>t.json()));u.feed("cat",t),u.feed("dog",t)}(),{update:function(t){if(c<=r)return c+=t/1e3;if(!s&&0===a.length){if("start"===l)return s=!1,function(){l="new";const[t,e]=Cool.shuffle(["cat","dog"]);o=m[t],a.push({speaker:t,text:"What was the point of that?",delay:p()}),a.push({speaker:e,text:u.getText(e,"C",{C:[["I think it was about","DT","NN","of","NN","."]]}).text,delay:p()}),a.push({speaker:t,text:u.getText(t,"C",{C:[["You don't think it was","Q"]]}).text,delay:p()}),a.push({speaker:e,text:u.getText(e,"C",{C:[["I guess it might have been","S"]]}).text,delay:p()}),a.push({speaker:t,text:u.getText(t,"C",{C:[["I don't think we really know what it was about."]]}).text,delay:p()})}(),d=!1,!0;"new"===l&&(s=!1,w())}if(!s){const t=a.shift();i=t.delay,s=t.speaker,o=m[t.speaker],o.isActive=!0,o.setMsg(t.text),n(s,!0)}const e=o.display();if(!e)return!1;e&&(r=i,c=0,o.isActive=!1,n(Cool.random(["cat","dog","tv","main"]),!1),s=!1)},isActive:()=>d,start(){d=!0}}}const{Game:e,Sprite:n,TextButton:a,TextSprite:o}=LinesEngine,s=new e({dps:20,width:960,height:720,retina:!0,debug:!0,stats:!0,suspend:!1,scenes:["main","cat","dog","tv","start"],lineWidth:1,events:["mouse"]});let i,c,r,d,l,m,u,p,w,h;s.load({sprites:"public/sprites.json"});let g=!1,f=function(){let t=!1;const e=document.getElementById("three"),n=new THREE.Scene,a=new THREE.PerspectiveCamera(75,960/720,.1,1e3),o=new THREE.WebGLRenderer({canvas:e,alpha:!0});o.setSize(960,720),document.body.appendChild(o.domElement);const s=new THREE.BoxGeometry,i=new THREE.MeshBasicMaterial({color:65535}),c=new THREE.Mesh(s,i);n.add(c),a.position.z=5;function r(){t&&(requestAnimationFrame(r),c.rotation.x+=.01,c.rotation.y+=.01,o.render(n,a))}return(new THREE.GLTFLoader).setPath("./public/models/").load("cat1.glb",(t=>{n.add(t.scene)})),{start(){t=!0,r(),e.classList.add("active")},stop(){t=!1,e.classList.remove("active")},isActive:()=>t}}(),C=!1;function y(t,e,n){if(n&&s.scenes.currentName===t){console.log("endDialog");("cat"===t?u:p).animation.state=Cool.randomInt(0,5)}else{if("cat"===t){const t=e?"cat":Cool.choice(["cat","dog"]);s.scenes.current=t,"cat"===t&&(u.animation.state=e?Cool.randomInt(6,10):Cool.randomInt(0,5)),"dog"===t&&(p.animation.state=Cool.randomInt(0,5))}if("dog"===t){const t=e?"dog":Cool.choice(["cat","dog"]);s.scenes.current=t,"cat"===t&&(u.animation.state=Cool.randomInt(0,5)),"dog"===t&&(p.animation.state=e?Cool.randomInt(6,10):Cool.randomInt(0,5))}"tv"===t&&(s.scenes.current="tv",w.animation.state=Cool.randomInt(0,w.animation.endFrame)),"main"===t&&(s.scenes.current="main",i.state=Cool.randomInt(0,i.animation.endFrame),c.state=Cool.randomInt(0,i.animation.endFrame),r.state=Cool.randomInt(0,i.animation.endFrame))}}document.addEventListener("keydown",(t=>{80===t.which&&(console.log("pause"),C=!C,console.log(C))})),s.start=function(){const{sprites:e}=s.anims,C=new a({x:100,y:100,msg:"Click to start with sound",wrap:26,letters:e.cat_letters,track:22,countForward:!0});s.scenes.start.addUI(C),C.onClick=function(){s.scenes.current="main",g=!0,h.start()};const k=new a({x:100,y:200,msg:"Click to start without sound",wrap:29,letters:e.cat_letters,track:22,countForward:!0});s.scenes.start.addUI(k),k.onClick=function(){s.scenes.current="main",g=!1,h.start()};const x=new n;x.addAnimation(e.tv_frame),s.scenes.addToDisplay(x,["start","main","cat","dog","tv"]),i=new n(500,-20),i.addAnimation(e.cat_main),s.scenes.main.addToDisplay(i),c=new n(-20,100),c.addAnimation(e.dog_main),s.scenes.main.addToDisplay(c),r=new n(260,265),r.addAnimation(e.tv_main),s.scenes.main.addToDisplay(r),u=new n(650,320),u.center=!0,u.addAnimation(e.cat_close),s.scenes.cat.addToDisplay(u),d=new o({x:100,y:100,letters:e.cat_letters,wrap:12,track:22,lead:60,countForward:!0,countBackward:!0,endDelay:20}),l=new o({x:500,y:200,letters:e.dog_letters,wrap:12,track:24,lead:60,countForward:!0,countBackward:!0,endDelay:20}),p=new n(250,350),p.center=!0,p.addAnimation(e.dog_close),s.scenes.dog.addToDisplay(p),w=new n(s.halfWidth,s.halfHeight),w.center=!0,w.addAnimation(e.tv_close),s.scenes.tv.addToDisplay(w),[i,c,r,u,p,w].forEach((t=>{for(let e=0;e<=t.animation.endFrame;e++)t.animation.createNewState(""+e,e,e);t.animation.state=Cool.randomInt(0,t.animation.endFrame)})),h=t(d,l,y),m={cat:u,dog:p},s.scenes.current="start",console.log("lines",s),f.start()},s.draw=function(t){if(!f.isActive()&&(s.scenes.current.display(),!C&&h.isActive())){!0===h.update(t)&&(y("tv"),f.start(),setTimeout((()=>{console.log("back"),f.stop(),y("main"),h.start()}),1e4))}},s.mouseDown=function(t,e){s.scenes.current.mouseDown(t,e)},s.mouseUp=function(t,e){s.scenes.current.mouseUp(t,e)},s.mouseMoved=function(t,e){s.scenes.current.mouseMoved(t,e)}}();
//# sourceMappingURL=src_maps/tv.min.js.map
